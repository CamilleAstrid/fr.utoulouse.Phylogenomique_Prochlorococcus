if (!require('ape')) {install.packages('ape')}
33
library(ape)
Prochlorococcus_Zhang_Code.file <- "~/work/Zhang/Prochlorococcus_Zhang_Code.txt"
Synechococcus_Zhang_Code.file <- "~/work/Zhang/Synechococcus_Zhang_Code.txt"
ortotreefile <-"~/work/OrthoFinder/Prochlorococcus/OrthoFinder/Results_Pro/WorkingDirectory/OrthoFinder/Results_ProSynmsa/Species_Tree/SpeciesTree_rooted.txt" 
orttr <- read.tree(ortotreefile)
orttr$tip.label
# un nom de souche n'est pas canonique: Syat.IS.tmp.2408106! 
orttr$tip.label <- substr(orttr$tip.label,1,4)
Prochlorococcus_Zhang_Code.file <- "~/work/Zhang/Prochlorococcus_Zhang_Code.txt"
Synechococcus_Zhang_Code.file <- "~/work/Zhang/Synechococcus_Zhang_Code.txt"
Prochlorococcus_Zhang_Code <- read.table(file=Prochlorococcus_Zhang_Code.file, sep="\t", row.names=1)
Synechococcus_Zhang_Code <- read.table(file=Synechococcus_Zhang_Code.file, sep="\t", row.names=1)
Zhang_Code <- rbind(Prochlorococcus_Zhang_Code, Synechococcus_Zhang_Code)
new.labels <- paste(Zhang_Code[orttr$tip.label, c(6)], substr(Zhang_Code[orttr$tip.label, c(14)], 8, 20), sep="_")
orttr$tip.label <- new.labels
# plot tree
pdf_file <- "~/work/OrthoFinder/Prochlorococcus/OrthoFinder/Results_Pro/WorkingDirectory/OrthoFinder/Results_ProSynmsa/Species_Tree/SpeciesTree_rooted.pdf"
pdf(file=pdf_file, paper="a4")
plot(orttr, edge.color="purple", edge.width=1, node.color= "grey", cex = 0.5, no.margin=FALSE, show.node.label=TRUE, tip.color="blue")
dev.off()
q()
