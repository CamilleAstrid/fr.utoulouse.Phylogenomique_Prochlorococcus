library(tidyverse)
supdata.file <- "~/work/Zhang/Zhang_Supplementary_Data.csv"
supdata.genomes <- read.table(supdata.file, sep = "\t", quote = "", header = T, stringsAsFactors = F)
supdata.genomes <- supdata.genomes %>%
    mutate(NCBI_Accession_ID=substr(NCBI_Accession_ID, 4,13))
four_letters_code <- function(prefix=Aa, max=26) {
  lc_alpha <- strsplit(intToUtf8(c(97:122)),"") 
  uc_alpha <- strsplit(intToUtf8(c(65:90)),"")
  code.list <- c()
  
  for ( i in 0:(max-1) ) {
    i1 <- floor(i/26)+1
    i2 <- i%%26+1
    code <- paste(prefix, lc_alpha[[1]][i1],lc_alpha[[1]][i2], sep="")
    code.list <- append(code.list, code)
  }
  return(code.list)
}
prochlo.refseq.genomes.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq.txt"
prochlo.refseq.genomes <- read.table(prochlo.refseq.genomes.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes <- prochlo.refseq.genomes %>% 
  mutate(assembly_accession=substr(assembly_accession, 4,13))
Prochlo_Zhang <- inner_join(supdata.genomes, prochlo.refseq.genomes, by = join_by(NCBI_Accession_ID == assembly_accession))
Prochlo_prefix <- "Pr"
Prochlo_max <- nrow(Prochlo_Zhang)
Code <- four_letters_code(Prochlo_prefix, Prochlo_max)
Prochlo_Code <- as.data.frame(Code)
Prochlo_Zhang.Code <- cbind(Prochlo_Code, Prochlo_Zhang)
Prochlo_Zhang.Code.file <- "~/work/Zhang/Prochlorococcus_Zhang_Code.txt"
write.table(Prochlo_Zhang.Code, file=Prochlo_Zhang.Code.file, quote = FALSE, sep = "\t", row.names =FALSE, col.names = FALSE)
synecho.refseq.genomes.file <- "~/work/Prochlorococcus/RefSeq/Synecho_assembly_summary_refseq.txt"
synecho.refseq.genomes <- read.table(synecho.refseq.genomes.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
synecho.refseq.genomes <- synecho.refseq.genomes %>% 
  mutate(assembly_accession=substr(assembly_accession, 4,13))
Synecho_Zhang <- inner_join(supdata.genomes, synecho.refseq.genomes, by = join_by(NCBI_Accession_ID == assembly_accession))
Synecho_prefix <- "Sy"
Synecho_max <- nrow(Synecho_Zhang)
Code <- four_letters_code(Synecho_prefix, Synecho_max)
Synecho_Code <- as.data.frame(Code)
Synecho_Code
Synecho_Zhang.Code <- cbind(Synecho_Code, Synecho_Zhang)
ncol(Synecho_Zhang.Code)
Synecho_Zhang.Code.file <- "~/work/Zhang/Synechococcus_Zhang_Code.txt"
write.table(Synecho_Zhang.Code, file=Synecho_Zhang.Code.file, quote = FALSE, sep = "\t", row.names =FALSE, col.names = FALSE)
q()
library(tidyverse)
supdata.file <- "~/work/Zhang/Zhang_Supplementary_Data.csv"
supdata.genomes <- read.table(supdata.file, sep = "\t", quote = "", header = T, stringsAsFactors = F)
supdata.genomes <- supdata.genomes %>%
    mutate(NCBI_Accession_ID=substr(NCBI_Accession_ID, 4,13))
four_letters_code <- function(prefix=Aa, max=26) {
  lc_alpha <- strsplit(intToUtf8(c(97:122)),"") 
  uc_alpha <- strsplit(intToUtf8(c(65:90)),"")
  code.list <- c()
  
  for ( i in 0:(max-1) ) {
    i1 <- floor(i/26)+1
    i2 <- i%%26+1
    code <- paste(prefix, lc_alpha[[1]][i1],lc_alpha[[1]][i2], sep="")
    code.list <- append(code.list, code)
  }
  return(code.list)
}
prochlo.refseq.genomes.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq.txt"
prochlo.refseq.genomes <- read.table(prochlo.refseq.genomes.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes <- prochlo.refseq.genomes %>% 
  mutate(assembly_accession=substr(assembly_accession, 4,13))
Prochlo_Zhang <- inner_join(supdata.genomes, prochlo.refseq.genomes, by = join_by(NCBI_Accession_ID == assembly_accession))
Prochlo_prefix <- "Pr"
Prochlo_max <- nrow(Prochlo_Zhang)
Code <- four_letters_code(Prochlo_prefix, Prochlo_max)
Prochlo_Code <- as.data.frame(Code)
Prochlo_Zhang.Code <- cbind(Prochlo_Code, Prochlo_Zhang)
Prochlo_Zhang.Code.file <- "~/work/Zhang/Prochlorococcus_Zhang_Code.txt"
write.table(Prochlo_Zhang.Code, file=Prochlo_Zhang.Code.file, quote = FALSE, sep = "\t", row.names =FALSE, col.names = FALSE)
synecho.refseq.genomes.file <- "~/work/Prochlorococcus/RefSeq/Synecho_assembly_summary_refseq.txt"
synecho.refseq.genomes <- read.table(synecho.refseq.genomes.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
synecho.refseq.genomes <- synecho.refseq.genomes %>% 
  mutate(assembly_accession=substr(assembly_accession, 4,13))
Synecho_Zhang <- inner_join(supdata.genomes, synecho.refseq.genomes, by = join_by(NCBI_Accession_ID == assembly_accession))
Synecho_prefix <- "Sy"
Synecho_max <- nrow(Synecho_Zhang)
Code <- four_letters_code(Synecho_prefix, Synecho_max)
Synecho_Code <- as.data.frame(Code)
Synecho_Code
Synecho_Zhang.Code <- cbind(Synecho_Code, Synecho_Zhang)
ncol(Synecho_Zhang.Code)
Synecho_Zhang.Code.file <- "~/work/Zhang/Synechococcus_Zhang_Code.txt"
write.table(Synecho_Zhang.Code, file=Synecho_Zhang.Code.file, quote = FALSE, sep = "\t", row.names =FALSE, col.names = FALSE)
q()
