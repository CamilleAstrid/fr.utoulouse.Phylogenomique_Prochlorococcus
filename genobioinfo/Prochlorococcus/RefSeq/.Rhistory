library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
library(ggplot2)
prochlo.refseq.genomes.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq.txt"
prochlo.refseq.genomes <- read.table(prochlo.refseq.genomes.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes <- prochlo.refseq.genomes %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## Genome_and_scaffold_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/Genome_and_scaffold_size.pdf'
pdf(file=pdf_file, paper="a4r")
prochlo.refseq.genomes %>%
ggplot(aes(y=genome_size, x=scaffold_count, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    theme_bw()
dev.off()
## Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/Genome_size_ori.pdf'
pdf(file=pdf_file, paper="a4r")
prochlo.refseq.genomes %>%
  ggplot( aes(x=genome_size, fill=assembly_level)) +
    geom_histogram( binwidth=100000, color="#e9ecef", alpha=0.8) +
    ggtitle("Bin size = 100000 bp") +
    theme_bw() +
    theme(
      plot.title = element_text(size=15)
    )
dev.off()
eixt
exit
quit
q
q()
library(tidyverse)
library(ggplot2)
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    theme_bw()
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    theme_bw()
dev.off()
q()
library(tidyverse)
library(ggplot2)
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    theme_bw()
dev.off()
q()
library(tidyverse)
library(ggplot2)
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    geom_smooth(method = "lm") +
    theme_bw()
dev.off()
q()
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
### Tracer la régression linéaire
mod <- lm(gc_percent ~ genome_size, data=prochlo.refseq.genomes.clean)
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    geom_abline(
        intercept = mod$coefficients[1],
        slope = mod$coefficients[2],
        linewidth = 1,
        colour = "red"
    )
    theme_bw()
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
### Tracer la régression linéaire
mod <- lm(gc_percent ~ genome_size, data=prochlo.refseq.genomes.clean)
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    geom_abline(
        intercept = mod$coefficients[1],
        slope = mod$coefficients[2],
        linewidth = 1,
        colour = "red"
    ) +
    theme_bw()
library(tidyverse)
library(ggplot2)
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
### Tracer la régression linéaire
mod <- lm(gc_percent ~ genome_size, data=prochlo.refseq.genomes.clean)
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    geom_abline(
        intercept = mod$coefficients[1],
        slope = mod$coefficients[2],
        linewidth = 1,
        colour = "red"
    ) +
    theme_bw()
dev.off()
q()
library(tidyverse)
library(ggplot2)
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 1,13))
## GC_percent_and_Genome_size
pdf_file <- '~/work/Prochlorococcus/RefSeq/GC_percent_and_Genome_size.pdf'
pdf(file=pdf_file, paper="a4r")
### Tracer la régression linéaire
mod <- lm(gc_percent ~ genome_size, data=prochlo.refseq.genomes.clean)
prochlo.refseq.genomes.clean %>%
ggplot(aes(y=gc_percent, x=genome_size, color=assembly_level)) + 
    geom_point(size=2, alpha=0.5) +
    geom_abline(
        intercept = mod$coefficients[1],
        slope = mod$coefficients[2],
        linewidth = 1,
        colour = "red"
    ) +
    theme_bw()
dev.off()
q()
if (!require('kableExtra')) {install.packages('kableExtra')}
33
if (!require('tidyverse')) {install.packages('tidyverse')}
33
if (!require('ggplot2')) {install.packages('ggplot2')}
33
library(kableExtra)
library(tidyverse)
library(ggplot2)
Prochlo.CheckM.file <- "~/work/Prochlorococcus/RefSeq/CheckM_output_folder/quality_report.tsv"
Prochlo.CheckM <- read.table(Prochlo.CheckM.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
Prochlo.CheckM <- Prochlo.CheckM %>% 
  mutate(Name=substr(Name, 1,13))
Prochlo.IQ <- Prochlo.CheckM %>% 
  filter(Completeness>99) %>%
  filter(Contamination<0.7)
Prochlo.CheckM.Quality <- Prochlo.IQ %>% 
  mutate(Quality = round(sqrt( (1 - Completeness/100)^2 + (Contamination)^2),  digits = 4 )) %>% 
  arrange(Quality) %>% 
  select(Name, Quality)
Prochlo.CheckM.Quality.file <- "~/work/Prochlorococcus/RefSeq/CheckM_output_folder/Prochlorococcus_Quality.txt"
write.table(Prochlo.CheckM.Quality, file=Prochlo.CheckM.Quality.file, quote = FALSE, sep = "\t", row.names =FALSE, col.names = FALSE)
head -n 2 ~/work/Prochlorococcus/RefSeq/CheckM_output_folder/Prochlorococcus_Quality.txt
q()
if (!require('kableExtra')) {install.packages('kableExtra')}
33
if (!require('tidyverse')) {install.packages('tidyverse')}
33
if (!require('ggplot2')) {install.packages('ggplot2')}
33
library(kableExtra)
library(tidyverse)
library(ggplot2)
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 3,15))
  
medoids.file <- "~/work/Prochlorococcus/RefSeq/CheckM_output_folder/Prochlorococcus_grraspQ.medoids.txt"
medoids <- read.table(medoids.file, sep = "\t", quote = "", col.names=c("Medoid"))
medoids.properties <- left_join(medoids, prochlo.refseq.genomes, by = join_by(Medoid == assembly_accession))
kable(medoids.properties %>% 
  select(c(infraspecific_name, assembly_level, scaffold_count)), 
      caption="Table 2 : Propriétés des médoïdes filtrés en fonction de leur qualité de séquençage")
prochlo.refseq.genomes.clean.file <- "~/work/Prochlorococcus/RefSeq/Prochlo_assembly_summary_refseq_clean_genome.txt"
prochlo.refseq.genomes.clean <- read.table(prochlo.refseq.genomes.clean.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
prochlo.refseq.genomes.clean <- prochlo.refseq.genomes.clean %>% 
  mutate(assembly_accession=substr(assembly_accession, 3,15))
  
medoids.file <- "~/work/Prochlorococcus/RefSeq/CheckM_output_folder/Prochlorococcus_grraspQ.medoids.txt"
medoids <- read.table(medoids.file, sep = "\t", quote = "", col.names=c("Medoid"))
medoids.properties <- left_join(medoids, prochlo.refseq.genomes.clean, by = join_by(Medoid == assembly_accession))
kable(medoids.properties %>% 
  select(c(infraspecific_name, assembly_level, scaffold_count)), 
      caption="Table 2 : Propriétés des médoïdes filtrés en fonction de leur qualité de séquençage")
kable(medoids.properties %>% 
  select(c(infraspecific_name, assembly_level, scaffold_count)), 
      caption="Table 2 : Propriétés des médoïdes filtrés en fonction de leur qualité de séquençage") %>%
      save_kable("~/work/Prochlorococcus/RefSeq/Prochlorococcus_grrasp.medoids.properties.quality-sort.txt")
q()
library(kableExtra)
library(tidyverse)
library(ggplot2)
Prochlo.CheckM.file <- "~/work/Prochlorococcus/RefSeq/CheckM_output_folder/quality_report.tsv"
Prochlo.CheckM <- read.table(Prochlo.CheckM.file, sep = "\t", quote = "", header = T, stringsAsFactors = T, skipNul=T)
Prochlo.CheckM <- Prochlo.CheckM %>% 
  mutate(Name=substr(Name, 1,13))
Prochlo.IQ <- Prochlo.CheckM %>% 
  filter(Completeness>99) %>%
  filter(Contamination<0.7)
Prochlo.IQ
Prochlo.CheckM.Quality <- Prochlo.IQ %>% 
  mutate(Quality = round(sqrt( (1 - Completeness/100)^2 + (Contamination)^2),  digits = 4 )) %>% 
  arrange(Quality) %>% 
  select(Name, Quality)
Prochlo.CheckM.Quality
Prochlo.CheckM.Quality.file <- "~/work/Prochlorococcus/RefSeq/CheckM_output_folder/Prochlorococcus_Quality.txt"
write.table(Prochlo.CheckM.Quality, file=Prochlo.CheckM.Quality.file, quote = FALSE, sep = "\t", row.names =FALSE, col.names = FALSE)
q()
